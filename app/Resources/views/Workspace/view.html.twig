{% extends "layout.html.twig" %}

{% block title %}
  {{ parent() }} - {{ws.name}}
{% endblock %}

{% block stylesheets %}
	
{% endblock %}

{% block body %}

	<div class="container-fluid">
		<div class="row text-center">
			<div class="col-lg-3">
				{% if pictureLogo[0] is defined %}
					<img src="{{ asset('images/Workspaces/') }}{{ws.name}}/{{pictureLogo[0].url}}" alt="{{pictureLogo[0].alt}}">
				{% else %}
					Pas de logo
				{% endif %}
			</div>
			<div class="col-lg-5">
				<h1 id="wsName">{{ws.name}}</h1>
			</div>
			<div class="col-lg-4">
				<div class="well">
					{% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
						{{ render(controller('BecowoCoreBundle:Vote:vote', {name: ws.name})) }}
						<button type="submit" class="btn btn-primary" onclick="goVote()">Voter !</button>
						<div id="VoteResults"></div>
					{% else %}
					Vous devez être <a href="{{ path('fos_user_security_login') }}">connecté</a> pour voter
					{% endif %}
				</div>
			</div>
		</div>
{############################################# Caroussel #########################################}
		<div class="row">
			<div class="col-lg-12">
				{% include 'Workspace/carroussel.html.twig' %}
			</div>
		</div>
{############################################# Description #########################################}
		<div class="row">
			<div class="col-lg-10">
				<h4>A propos de cet espace</h4> 
				{{averageVote|rating}}
				<p>{{ws.description}}</p>
				<div class="well well-sm">
					{{ws.descriptionBonus}}
				</div>
			</div>
{############################################# Horaires #########################################}
			<div class="col-lg-2">
				<div class="well">
					<center><i class="fa fa-clock-o fa-6" aria-hidden="true"></i></center>
					{{ws.openHoursInfo}}
					<br>
					<a href="{{ws.website}}" target="_blank">{{ws.website}}</a><br>
					<br>
					<button type="button" class="btn btn-primary">Contacter le Manager</button>
				</div>
			</div>
		</div>
		<hr>
{############################################# Services #########################################}
		<div class="row">
			<div class="col-lg-9">
				<h4>Les services</h4>
				<ul>
					{% for amenity in ws.amenities %}
						<li>{{amenity.name}}</li>
					{% endfor %}
				</ul>
			</div>
{############################################# Panel Map #########################################}
			<div class="col-lg-3">
				{# La taille de la carte joue sur les options affichées : itinéraire... #}
				<div class="well">
					<div class="embed-responsive embed-responsive-16by9">
						<span id="address_ws"> {{ws.name}} {{ws.street}} {{ws.postcode}} {{ws.city}}</span>
				    	<iframe id="map_ws" class="embed-responsive-item" allowfullscreen></iframe>
					</div><br>
					{{ws.street|capitalize}} <br>
			  		{{ws.postcode}} {{ws.city}} <br>
				</div>
			</div>
		</div>
		<hr>
{############################################# Offices #########################################}
		<div class="row">
			<div class="col-lg-9">
				<h4>Les Bureaux</h4>
				<ul>
					{% for office in listOffices %}
						<li>{{office.office.name}} ({{office.DeskQty}} bureaux)</li>
					{% endfor %}
				</ul>
			</div>
{############################################# Panel Event #########################################}
			<div class="col-lg-3">
				<div class="well">
					<h4>Evenements</h4>
					<p>Ne manquez pas les évènements chez {{ws.name}}</p>
					{% include 'Workspace/events.html.twig' %}
				</div>
			</div>
		</div>
		<hr>
{############################################# Booking #########################################}
		<div class="row">
			<div class="col-lg-12">
				{% include 'Workspace/book.html.twig' %}
			</div>
		</div>
		<hr>
		<br>
{############################################# Team #########################################}
		<div class="row">
			<div class="col-lg-2">
				<div class="well">
					<center>
					<h4>L'équipe à votre service</h4>
					{% include 'Workspace/teamMembers.html.twig' %}
					</center>
				</div>
			</div>
		</div>
{############################################# Commentaires #########################################}
		<div class="row">
			<div class="col-lg-8">
				<div class="well">
					<div id="CommentResults">
						{{ render(controller('BecowoCoreBundle:Comment:view', {name: ws.name})) }}
					</div>
				</div>
			</div>
		</div>


	</div>

{% block javascripts %}
	<script type="text/javascript">

$(function () {
    $("#comment_Envoyer").unbind("click").click(function(){
    	$.ajax(Routing.generate('becowo_comment', {name: document.getElementById('wsName').innerHTML}), {
                    data: $('#comment-form').serialize(),
                    type: "POST",
                    success: function(data) {
                        $('#CommentResults').html(data);
                    },
                    error: function() {
                    	$('#CommentResults').html("Une erreur est survenue, veuillez réessayer plus tard");
                    }
                });
    		return false;
    });
});

    function goVote(){
    	$.ajax(Routing.generate('becowo_core_vote', {name: document.getElementById('wsName').innerHTML}), {
    				data: $('#vote-form').serialize(),
                    type: "POST",
                    success: function(data) {
                    	$('#VoteResults').html("Merci, vote comptabilisé !");
                    },
                    error: function() {
                    	$('#VoteResults').html("Une erreur est survenue, veuillez réessayer plus tard");
                    }
                });
    		return false;
    }
    </script>
    
{% endblock javascripts %}

{% endblock body %}
